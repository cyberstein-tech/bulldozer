const i=PIXI.autoDetectRenderer({antialias:!0,autoDensity:!0,resolution:window.devicePixelRatio,width:320,height:256,backgroundColor:8421376,autoResize:!0});let n,l;let o,r,a=16,s=[],f=[],c=0,d=-1,u=[],p=[];const g=["Good job!","Awesome!","Props!","Way to go!","Nailed it!","Good Game!","Kudos!","Hats off!","A round of applause...","Keep going!","Slow poke..","Slow down!","Nice!","Take it easy on the caffeine, sheeez","Almost there..","Boom!","Yay, now take a break!","Okay, take a stretch now!","You do not give up, nice!","Bazinga!"],y=16,m=20;let w,k,h;!async function(n,i){for(let e=0;e<n;e++)s[e]=[];for(let t=0;t<n;t++)for(let e=0;e<i;e++)s[t][e]=-4;return s}(y,m),t(0),document.getElementById("canvas").appendChild(i.view);const b=new PIXI.Loader;var e=window.innerWidth;function v(){l.clear();b.resources;var e=i.screen.width,t=i.screen.height,t=(a,t/a);Math.floor(t/2);for(let t=k=0;t<20;t++)for(let e=0;e<16;e++){var n=s[e][t];n<0?-8===n?l.tile("brick8.png",t*a,e*a):-7===n?l.tile("brick7.png",t*a,e*a):-6===n?l.tile("brick6.png",t*a,e*a):-5===n?l.tile("brick5.png",t*a,e*a):-4===n?l.tile("brick4.png",t*a,e*a):-3===n?l.tile("brick3.png",t*a,e*a):-2===n?l.tile("brick2.png",t*a,e*a):l.tile("brick1.png",t*a,e*a):0<n&&(1===n?l.tile("bullseye.png",t*a,e*a):2===n?l.tile("boulder.png",t*a,e*a):3===n?(l.tile("bullseye-boulder.png",t*a,e*a),k++):(n%10==4?l.tile("bulldozer-up.png",t*a,e*a):n%10==5?l.tile("bulldozer-down.png",t*a,e*a):n%10==6?l.tile("bulldozer-left.png",t*a,e*a):l.tile("bulldozer-right.png",t*a,e*a),o=e,r=t))}}async function t(t){if(Math.floor(t/10)!=d){d=Math.floor(t/10);let e=await async function(t){t="mapsets/"+t+".txt";try{let e=await fetch(t);if(200===e.status)return e.text();console.log(e.status)}catch(e){console.log(e)}}(d);if(null==e)return alert("Unable to fetch map data. Maybe try again?"),null;u=[],u=e.split(/\r\n|\n\r|\n|\r/)}I(t)}async function I(e){p=[];var t=e%10;p=u[t].split(/\s+/);let n=0;h=0,w=0;for(let t=k=0;t<y;t++)for(let e=0;e<m;e++)s[t][e]=Number(p[n++]),1===s[t][e]&&w++,3===s[t][e]&&k++;c=e,document.getElementById("level").textContent="Level "+c,h=w+k}async function L(e){e&&(await t(e),v())}function T(e){if(s[o][r]=10<e?1:0,v(),k===h){let t=Number(c)+1;setTimeout(()=>{var e=c%20;conVal=confirm(g[e]+"\n\nLoading level "+t+" now..."),1==conVal&&L(t)},500)}}640<=e?(C(640,512),a=32,b.add("TilemapLegend","assets/TilemapLegend32.json")):e<640&&480<=e?(C(480,384),a=24,b.add("TilemapLegend","assets/TilemapLegend24.json")):b.add("TilemapLegend","assets/TilemapLegend16.json"),b.load((e,t)=>{n=new PIXI.Container,l=new PIXI.tilemap.CompositeTilemap,n.addChild(l),PIXI.Ticker.shared.add(()=>i.render(n)),v()}),document.addEventListener("keydown",function(e){"ArrowUp"===e.key||"w"===e.key?function(){var e,t,n;let i=!1;if(e=s[o][r],t=s[o-1][r],n=s[o-2][r],!(t<0)){if(0===t)s[o-1][r]=4,i=!0;else if(1===t)s[o-1][r]=14,i=!0;else if(2===t)if(0==n)s[o-1][r]=4,s[o-2][r]=2,i=!0;else{if(1!=n)return;s[o-1][r]=4,s[o-2][r]=3,k++,i=!0}else if(0==n)s[o-1][r]=14,s[o-2][r]=2,k--,i=!0;else{if(1!=n)return;s[o-1][r]=14,s[o-2][r]=3,i=!0}1==i&&(f=[],f.push(o,r,e,o-1,r,t,o-2,r,n)),T(e)}}():"ArrowLeft"===e.key||"a"===e.key?function(){var e,t,n;let i=!1;if(e=s[o][r],t=s[o][r-1],n=s[o][r-2],!(t<0)){if(0===t)s[o][r-1]=6,i=!0;else if(1===t)s[o][r-1]=16,i=!0;else if(2===t)if(0==n)s[o][r-1]=6,s[o][r-2]=2,i=!0;else{if(1!=n)return;s[o][r-1]=6,s[o][r-2]=3,k++,i=!0}else if(0==n)s[o][r-1]=16,s[o][r-2]=2,k--,i=!0;else{if(1!=n)return;s[o][r-1]=16,s[o][r-2]=3,i=!0}1==i&&(f=[],f.push(o,r,e,o,r-1,t,o,r-2,n)),T(e)}}():"ArrowRight"===e.key||"d"===e.key?function(){var e,t,n;let i=!1;if(e=s[o][r],t=s[o][r+1],n=s[o][r+2],!(t<0)){if(0===t)s[o][r+1]=7,i=!0;else if(1===t)s[o][r+1]=17,i=!0;else if(2===t)if(0==n)s[o][r+1]=7,s[o][r+2]=2,i=!0;else{if(1!=n)return;s[o][r+1]=7,s[o][r+2]=3,k++,i=!0}else if(0==n)s[o][r+1]=17,s[o][r+2]=2,k--,i=!0;else{if(1!=n)return;s[o][r+1]=17,s[o][r+2]=3,i=!0}1==i&&(f=[],f.push(o,r,e,o,r+1,t,o,r+2,n)),T(e)}}():"ArrowDown"!==e.key&&"s"!==e.key||function(){var e,t,n;let i=!1;if(e=s[o][r],t=s[o+1][r],n=s[o+2][r],!(t<0)){if(0===t)s[o+1][r]=5,i=!0;else if(1===t)s[o+1][r]=15,i=!0;else if(2===t)if(0==n)s[o+1][r]=5,s[o+2][r]=2,i=!0;else{if(1!=n)return;s[o+1][r]=5,s[o+2][r]=3,k++,i=!0}else if(0==n)s[o+1][r]=15,s[o+2][r]=2,k--,i=!0;else{if(1!=n)return;s[o+1][r]=15,s[o+2][r]=3,i=!0}1==i&&(f=[],f.push(o,r,e,o+1,r,t,o+2,r,n)),T(e)}}()});var z=document.getElementById("myModal");let A=document.getElementsByClassName("close")[0];function C(e,t){i.resize(e,t)}A.onclick=function(){z.style.display="none"},window.onclick=function(e){e.target==z&&(z.style.display="none")};
